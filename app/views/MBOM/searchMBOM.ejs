<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title><%= title %></title>
    <meta content="Quote Detail" name="SAI-APS-Portal" />
    <link rel="shortcut icon" href="/public/assets/images/SAI-Logo.JPG">
    <link rel="stylesheet" href="/public/plugins/morris/morris.css">

    <link href="/public/plugins/RWD-Table-Patterns/dist/css/rwd-table.min.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="/public/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css" rel="stylesheet" />
    <link href="/public/plugins/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css" rel="stylesheet" />
    <link href="/public/plugins/select2/css/select2.min.css" rel="stylesheet" type="text/css" />
    <link href="/public/plugins/bootstrap-touchspin/css/jquery.bootstrap-touchspin.min.css" rel="stylesheet" />

    <link href="/public/assets/css/breakerDragDrop.css" rel="stylesheet" type="text/css" />
    <link href="/public/plugins/jquery-ui/jquery-ui.min.css" rel="stylesheet" type="text/css" />
    <!-- ION Slider -->
    <link href="/public/plugins/ion-rangeslider/ion.rangeSlider.css" rel="stylesheet" type="text/css"/>
    <link href="/public/plugins/ion-rangeslider/ion.rangeSlider.skinModern.css" rel="stylesheet" type="text/css"/>

    <link href="/public/assets/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/public/assets/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/public/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/public/assets/css/style.css" rel="stylesheet" type="text/css">
    <link href="/public/assets/css/mbomBrkTable.css" rel="stylesheet" type="text/css">
    <link href="/public/assets/css/mbomShipLoose.css" rel="stylesheet" type="text/css">
    <script>
        document.addEventListener("DOMContentLoaded", function(event) {
            let scrollpos = localStorage.getItem('scrollpos');
            if (scrollpos) window.scrollTo(0, scrollpos);
        });

        window.onbeforeunload = function(e) {
            localStorage.setItem('scrollpos', window.scrollY);
        };
    </script>
    <style>
        div{
            overflow: visible !important;
        }
    </style>
</head>

<body>
<div id="wrapper">
    <!-- Top Bar Start -->
    <div class="topbar">

        <!-- LOGO -->
        <div class="topbar-left" style="background-color: white;">
            <a href="../" class="logo">
                        <span>
                            <img src="/public/assets/images/SAI-Logo.JPG" alt="" height="67">
                        </span>
                <i>
                    <img src="/public/assets/images/SAI-Logo.JPG" alt="" height="22">
                </i>
            </a>
        </div>

        <nav class="navbar-custom">
            <ul class="navbar-right d-flex list-inline float-right mb-0">
                <li class="dropdown notification-list d-none d-sm-block">
                    <form role="search" class="app-search">
                        <div class="form-group mb-0">
                            <input type="text" class="form-control" placeholder="Search..">
                            <button type="submit"><i class="fa fa-search"></i></button>
                        </div>
                    </form>
                </li>
            </ul>

            <ul class="list-inline menu-left mb-0">
                <li class="float-left">
                    <button class="button-menu-mobile open-left waves-effect">
                        <i class="mdi mdi-menu"></i>
                    </button>
                </li>
            </ul>

        </nav>

    </div>
    <!-- Top Bar End -->

    <!-- ========== Left Sidebar Start ========== -->
    <div class="left side-menu">
        <div class="slimscroll-menu" id="remove-scroll">

            <!--- Sidemenu -->
            <div id="sidebar-menu">
                <!-- Left Menu Start -->
                <ul class="metismenu" id="side-menu">
                    <li class="menu-title">CREO Automation</li>
                    <li>
                        <a href="../PDF-DXF-BIN_BOM" class="waves-effect">
                            <i class="mdi mdi-content-duplicate"></i> <span> PDF / DXF / BIN BOM </span>
                        </a>
                    </li>
                    <li>
                        <a href="../submittal" class="waves-effect">
                            <i class="mdi mdi-file-pdf"></i> <span> Submittal </span>
                        </a>
                    </li>
                    <li>
                        <a href="../MBOM" class="waves-effect">
                            <i class="mdi mdi-file-pdf"></i> <span> MBOM </span>
                        </a>
                    </li>
                </ul>

            </div>
            <!-- Sidebar -->
            <div class="clearfix"></div>

        </div>
        <!-- Sidebar -left -->

    </div>
    <!-- Left Sidebar End -->

<div class="content-page">
<!-- Content Start -->
<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-12">
                <div class="page-title-box">
                    <h4 class="page-title">Mechanical Engineering - BOM Configure</h4>
                    <div class="row">
                        <div class="col-sm-12">
                            <!--< % include ../Partials/TinyCharts % >-->
                        </div>
                    </div>
                    <div class="row justify-content-center">
                        <div class="col-sm-12">
                            <div class="card m-b-20">
                                <div class="card-body">
                                    <h4 class="mt-0 header-title">Current Job</h4>
                                    <form id="jobSelectForm" class="jobSelectForm" action="" method="POST">
                                        <div class="form-group">
                                            <% if(mbomData) { %>
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <label for="jobNum" class="col-form-label">Job #</label>
                                                        <input type="text" id="jobNum" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" placeholder="Type Number Here" readonly="readonly">
                                                    </div>
                                                    <div class="col-sm-1">
                                                        <label for="releaseNum" class="col-form-label">Release</label>
                                                        <input type="text" id="releaseNum" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" placeholder="Type Release Here" readonly="readonly">
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label for="" class="col-form-label">Job Name</label>
                                                        <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" placeholder="Type Name Here" id="jobName" readonly="readonly">
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label for="" class="col-form-label">Customer</label>
                                                        <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" placeholder="Type Customer Here" id="customer" readonly="readonly">
                                                    </div>
                                                    <div class="col-sm-4">
                                                        <label for="" class="col-form-label">Board Designation</label>
                                                        <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" placeholder="Type Designation Here" id="boardDesignation" readonly="readonly">
                                                    </div>
                                                </div>
                                            <% } %>
                                        </div>
                                    </form>
                                    <div class="row justify-content-center">
                                        <div class="col-2">
                                            <input id="editMbomButton" type="button" value="Edit" class="btn-block btn-lg btn-outline-warning waves-effect waves-light" data-toggle="modal" data-target="#editMbomModal"/>
                                            <!-- Modal -->
                                            <div class="modal fade" id="editMbomModal" tabindex="-1" role="dialog" aria-labelledby="editMbomModalTitle" aria-hidden="true">
                                                <div class="modal-dialog modal-dialog-centered" role="document">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h5 class="modal-title" id="editMbomModalTitle">Edit MBOM</h5>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                        <div class="modal-body">
                                                            <form id="editMbomForm" class="editMbomForm" action="../editMBOM/?mbomID=<%= mbomID %>" method="POST">
                                                                <div class="form-group">
                                                                    <p class="mb-0">
                                                                        Please fill out the following and click "Save" afterwards
                                                                    </p>
                                                                    <p class="text-muted m-b-5"></p>
                                                                    <div class="row">
                                                                        <div class="col-sm-8">
                                                                            <label for="" class="col-form-label">Job #</label>
                                                                            <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" placeholder="Type Number Here" id="" readonly="readonly">
                                                                        </div>
                                                                        <div class="col-sm-4">
                                                                            <label for="" class="col-form-label">Release</label>
                                                                            <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" placeholder="Type Release Here" id="" readonly="readonly">
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <label for="" class="col-form-label">Job Name</label>
                                                                            <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" placeholder="Type Name Here" id="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <label for="" class="col-form-label">Customer</label>
                                                                            <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" placeholder="Type Customer Here" id="">
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <label for="" class="col-form-label">Board Designation</label>
                                                                            <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" placeholder="Type Designation Here" id="">
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer justify-content-center">
                                                                    <div class="w-50">
                                                                        <% if(mbomData) { %>
                                                                            <input id="editMbomModalButton" type="submit" value="Save" class="btn-block btn-lg btn-info" />
                                                                        <% } %>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- END MODAL -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="card m-b-20">
                                <div class="card-body">
                                    <h4 class="mt-0 header-title">Section Summary</h4>
                                    <form id="mbomAddSection" class="mbomAddSection" action="" method="POST">
                                        <div class="row">
                                            <% if(mbomData) { %>
                                                <div class="col-sm-12">
                                                    <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" id="jobNum" hidden="hidden">
                                                    <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" id="releaseNum" hidden="hidden">
                                                    <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" id="mbomID" hidden="hidden">
                                                    <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" id="jobName" hidden="hidden">
                                                    <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" id="customer" hidden="hidden">
                                                    <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" id="boardDesignation" hidden="hidden">
                                                    <input type="text" name="numSections" class="form-control" value="<%= mbomData.numSections %>" id="numSections" hidden="hidden">
                                                </div>
                                            <% } %>
                                            <div class="col-sm-2">
                                                <label for="" class="col-form-label"></label>
                                                <button id="addSectionBtn" type="submit" class="btn-block btn-lg btn-outline-secondary waves-effect waves-light add-button" onclick="this.form.action='/mbomAddSection'">Add Section</button>
                                            </div>
                                            <div class="col-sm-2">
                                                <label for="" class="col-form-label"></label>
                                                <input id="resetSectionBtn" type="button" value="Clear All" class="btn-block btn-lg btn-outline-danger waves-effect waves-light" data-toggle="modal" data-target="#resetModal"/>

                                                <!-- Modal -->
                                                <div class="modal fade" id="resetModal" tabindex="-1" role="dialog" aria-labelledby="resetModalTitle" aria-hidden="true">
                                                    <div class="modal-dialog modal-dialog-centered" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLongTitle" style="font-size: x-large">Whoa there...</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body text-center" style="font-size: medium">
                                                                Are you sure you want to clear all sections?
                                                            </div>
                                                            <div class="modal-footer justify-content-center">
                                                                <input id="resetSectionBtn" type="submit" value="Yes" class="btn-block btn-lg btn-secondary col-sm-5" style="border: 0" onclick="this.form.action='/mbomResetSection'" />
                                                                <button type="button" class="btn-block btn-lg btn-danger col-sm-5" data-dismiss="modal" style="margin-top: 0">No</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- END MODAL -->
                                            </div>
                                            <%
                                            let shipLoose = false;
                                            for(let row of mbomItemData) {
                                                if (row.shipLoose == 'Y'){
                                                    shipLoose = true;
                                                    break;
                                                }
                                            }
                                            %>
                                            <% if(shipLoose){ %>
                                                <div class="col-sm-3"></div>
                                                <div class="col-sm-5 outerShipLooseDiv" style="padding-top: 1.1rem;">
                                                    <div class="row">
                                                        <div class="col-sm-12 shipLooseHeading">
                                                            <h6>Ship Loose Items</h6>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-sm-12 shipLooseDiv">
                                                            <ul class="shipLooseUL">
                                                                <% for(let row of mbomItemData){ %>
                                                                    <% if(row.shipLoose == 'Y' && row.userItemID == null){ %>
                                                                    <%for(let el of comItemData){ %>
                                                                        <% if(el.comItemID == row.comItemID){%>
                                                                            <li class="shipLooseLI">
                                                                                <span class="badge badge-light"><%= row.itemQty %></span>
                                                                                <%= el.itemDesc %>
                                                                            </li>
                                                                        <% } %>
                                                                    <% } %>
                                                                    <% } else if(row.shipLoose == 'Y' && row.comItemID == null){ %>
                                                                        <% for(let el of userItemData){ %>
                                                                            <% if(el.userItemID == row.userItemID){ %>
                                                                                <li class="shipLooseLI">
                                                                                    <span class="badge badge-light"><%= row.itemQty %></span>
                                                                                    <%= el.itemDesc %>
                                                                                </li>
                                                                            <% } %>
                                                                        <% } %>
                                                                    <% } %>
                                                                <% } %>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            <% } %>
                                        </div>
                                        <div class="row" style="width: 100%; margin-left: .1rem;">
                                            <div class="col-sm-2" style="position: sticky; top: 100px; margin-top: 2rem;">
                                                <h6>Item Queue</h6>
                                                <ol data-draggable="target" id="itemQueue" class="itemQueue" style="width: 100%;">
                                                    <% if(mbomItemData.length != 0){ %>
                                                        <% for(let i = 0; i < mbomItemData.length; i++){ %>
                                                            <% let currentItem = mbomItemData[i].itemSumID; %>
                                                            <% if(mbomSecData.length != 0){ %>
                                                                <% let usedItems = []; %>
                                                                <% if(mbomItemData[i].secID != null){ %>
                                                                    <% usedItems.push(mbomItemData[i].itemSumID); %>
                                                                <% } %>
                                                                <% if(usedItems.includes(currentItem)){ %>
                                                                <% } else { %>
                                                                    <% if(userItemData.length != 0){ %>
                                                                        <% for(let j = 0; j < userItemData.length; j++){ %>
                                                                            <% if(mbomItemData[i].userItemID == userItemData[j].userItemID && mbomItemData[i].shipLoose == 'N'){ %>
                                                                                <li id="I<%= mbomItemData[i].itemSumID%>" data-draggable="item" style="background-color: #c5cd98;">
                                                                                    <span class="badge badge-light"><%= mbomItemData[i].itemQty %></span>
                                                                                    <%= userItemData[j].itemDesc %>
                                                                                </li>
                                                                            <% } %>
                                                                        <% } %>
                                                                    <% } %>
                                                                    <% if(comItemData.length != 0){%>
                                                                        <% for(let j = 0; j < comItemData.length; j++){ %>
                                                                            <% if(mbomItemData[i].comItemID == comItemData[j].comItemID && mbomItemData[i].shipLoose == 'N'){ %>
                                                                                <li id="I<%= mbomItemData[i].itemSumID%>" data-draggable="item" style="background-color: #c5cd98;">
                                                                                    <span class="badge badge-light"><%= mbomItemData[i].itemQty %></span>
                                                                                    <%= comItemData[j].itemDesc %>
                                                                                </li>
                                                                            <% } %>
                                                                        <% } %>
                                                                    <% } %>
                                                                <% } %>
                                                            <% } else { %>
                                                                <%if(userItemData.length != 0){%>
                                                                    <% for(let j = 0; j < userItemData.length; j++){ %>
                                                                        <% if(mbomItemData[i].userItemID == userItemData[j].userItemID && mbomItemData[i].shipLoose == 'N'){ %>
                                                                            <li id="I<%= mbomItemData[i].itemSumID%>" data-draggable="item" style="background-color: #c5cd98;">
                                                                                <span class="badge badge-light"><%= mbomItemData[i].itemQty %></span>
                                                                                <%= userItemData[j].itemDesc %>
                                                                            </li>
                                                                        <% } %>
                                                                    <% } %>
                                                                <% } %>
                                                                <% if(comItemData.length != 0){%>
                                                                    <% for(let j = 0; j < comItemData.length; j++){ %>
                                                                        <% if(mbomItemData[i].comItemID == comItemData[j].comItemID && mbomItemData[i].shipLoose == 'N'){ %>
                                                                            <li id="I<%= mbomItemData[i].itemSumID%>" data-draggable="item" style="background-color: #c5cd98;">
                                                                                <span class="badge badge-light"><%= mbomItemData[i].itemQty %></span>
                                                                                <%= comItemData[j].itemDesc %>
                                                                            </li>
                                                                        <% } %>
                                                                    <% } %>
                                                                <% } %>
                                                            <% } %>
                                                        <% } %>
                                                    <% } %>
                                                </ol>
                                            </div>
                                            <div class="col-sm-2" style="position: sticky; top: 100px; margin-top: 2rem;">
                                                <h6>MCCB Queue</h6>
                                                <ol data-draggable="target" id="mcBrkQueue" class="breakerQueueMC" style="width: 100%;">
                                                    <% if(mbomBrkData.length != 0) { %>
                                                        <% for (let k=0; k < mbomBrkData.length; k++) { %>
                                                            <% let devProduct = (mbomBrkData[k].catCode).includes('MC'); %>
                                                            <% if(devProduct){ %>
                                                                <% var currentMouldedBrk = mbomBrkData[k].idDev; %>
                                                                <% if(mbomSecData.length != 0) { %>
                                                                    <% var usedMouldedBrks = []; %>
                                                                    <% if(mbomBrkData[k].secID != null){ %>
                                                                        <% usedMouldedBrks.push(mbomBrkData[k].idDev); %>
                                                                    <% } %>
                                                                    <% if (usedMouldedBrks.includes(currentMouldedBrk)) { %>
                                                                    <% } else { %>
                                                                        <li id="B<%= mbomBrkData[k].idDev%>" data-draggable="item" style="background-color: #fcca9c;">
                                                                            <%= mbomBrkData[k].devDesignation %>
                                                                        </li>
                                                                    <% } %>
                                                                <% } else { %>
                                                                    <li id="B<%= mbomBrkData[k].idDev%>" data-draggable="item" style="background-color: #fcca9c;">
                                                                        <%= mbomBrkData[k].devDesignation %>
                                                                    </li>
                                                                <% } %>
                                                            <% } %>
                                                        <% } %>
                                                    <% } %>
                                                </ol>
                                                <h6>ICCB Queue</h6>
                                                <ol data-draggable="target" id="icBrkQueue" class="breakerQueueIC" style="width: 100%;">
                                                    <% if(mbomBrkData.length != 0) { %>
                                                        <% for (let k=0; k < mbomBrkData.length; k++) { %>
                                                            <% let devProduct = (mbomBrkData[k].catCode).includes('IC'); %>
                                                            <% if(devProduct){ %>
                                                                <% var currentICBrk = mbomBrkData[k].idDev; %>
                                                                <% if(mbomSecData.length != 0) { %>
                                                                    <% var usedICBrks = []; %>
                                                                    <% if(mbomBrkData[k].secID != null){ %>
                                                                        <% usedICBrks.push(mbomBrkData[k].idDev); %>
                                                                    <% } %>
                                                                    <% if (usedICBrks.includes(currentICBrk)) { %>
                                                                    <% } else { %>
                                                                        <li id="B<%= mbomBrkData[k].idDev%>" data-draggable="item" style="background-color: #b1e7d5;">
                                                                            <%= mbomBrkData[k].devDesignation %>
                                                                        </li>
                                                                    <% } %>
                                                                <% } else { %>
                                                                    <li id="B<%= mbomBrkData[k].idDev%>" data-draggable="item" style="background-color: #b1e7d5;">
                                                                        <%= mbomBrkData[k].devDesignation %>
                                                                    </li>
                                                                <% } %>
                                                            <% } %>
                                                        <% } %>
                                                    <% } %>
                                                </ol>
                                            </div>
                                            <div class="row" style="margin-left: 33.5%; width: 100%; margin-top: -22.1rem">
                                                <% if(mbomData) { %>
                                                    <% for (let i=0; i < mbomData.numSections; i++) { %>
                                                        <div class="col-sm-3">
                                                            <%if( i < 9){%>
                                                            <h6>Section 10<%=i+1%>
                                                                <input id="deleteSectionBtn" type="submit" value="&times;" class="close" style="margin: -2px 25px auto 25px; border: white; background: white" onclick="this.form.action='../mbomDeleteSection/?selectedSec=<%= i+1 %>&numSections=<%= mbomData.numSections%>'" />
                                                            </h6>
                                                            <% } else{ %>
                                                            <h6>Section 1<%=i+1%>
                                                                <input id="deleteSectionBtn" type="submit" value="&times;" class="close" style="margin: -2px 25px auto 25px; border: white; background: white" onclick="this.form.action='../mbomDeleteSection/?selectedSec=<%= i+1 %>&numSections=<%= mbomData.numSections%>'" />
                                                            </h6>
                                                            <% } %>
                                                            <ol data-draggable="target" id="section<%=i+1%>" style="width: 100%;">
                                                                <% if(mbomItemData.length != 0){ %>
                                                                    <% for(let j = 0; j < mbomItemData.length; j++){ %>
                                                                        <% let currentItem = mbomItemData[j].itemSumID; %>
                                                                        <% if(mbomItemData[j].secID != null){ %>
                                                                            <% for(let k = 0; k < mbomSecData.length; k++){  %>
                                                                                <% let usedItems = []; %>
                                                                                <% if(mbomSecData[k].secID == mbomItemData[j].secID){ %>
                                                                                    <% if(mbomSecData[k].sectionNum == i+1){ %>
                                                                                        <% usedItems.push(mbomItemData[j].itemSumID); %>
                                                                                    <% } %>
                                                                                <% } %>
                                                                                <% if(usedItems.includes(currentItem)){ %>
                                                                                    <%if(userItemData.length != 0){%>
                                                                                        <% for(let k = 0; k < userItemData.length; k++){ %>
                                                                                            <% if(mbomItemData[j].userItemID == userItemData[k].userItemID && mbomItemData[j].shipLoose == 'N'){ %>
                                                                                                <li id="I<%= mbomItemData[j].itemSumID%>" data-draggable="item" style="background-color: #c5cd98;">
                                                                                                    <span class="badge badge-light"><%= mbomItemData[j].itemQty %></span>
                                                                                                    <%= userItemData[k].itemDesc %>
                                                                                                </li>
                                                                                            <% } %>
                                                                                        <% } %>
                                                                                    <% } %>
                                                                                    <% if(comItemData.length != 0){%>
                                                                                        <% for(let k = 0; k < comItemData.length; k++){ %>
                                                                                            <% if(mbomItemData[j].comItemID == comItemData[k].comItemID && mbomItemData[j].shipLoose == 'N'){ %>
                                                                                                <li id="I<%= mbomItemData[j].itemSumID%>" data-draggable="item" style="background-color: #c5cd98;">
                                                                                                    <span class="badge badge-light"><%= mbomItemData[j].itemQty %></span>
                                                                                                    <%= comItemData[k].itemDesc %>
                                                                                                </li>
                                                                                            <% } %>
                                                                                        <% } %>
                                                                                    <% } %>
                                                                                <% } %>
                                                                            <% } %>
                                                                        <% } %>
                                                                    <% } %>
                                                                <% } %>
                                                                <% if(mbomBrkData.length != 0) { %>
                                                                    <% for (let j=0; j < mbomBrkData.length; j++) { %>
                                                                        <% let currentBrk = mbomBrkData[j].idDev; %>
                                                                        <% let brkAcc = []; %>
                                                                        <% let brkAccQty = []; %>
                                                                        <% if(mbomBrkData[j].secID != null){ %>
                                                                            <% for (let k=0; k < mbomSecData.length; k++) { %>
                                                                                <% let usedBrks = []; %>
                                                                                <% if(mbomSecData[k].secID == mbomBrkData[j].secID){ %>
                                                                                    <% if(mbomSecData[k].sectionNum == i+1){ %>
                                                                                        <% usedBrks.push(mbomBrkData[j].idDev); %>
                                                                                    <% } %>
                                                                                <% } %>
                                                                                <% if (usedBrks.includes(currentBrk)) { %>
                                                                                    <% for (let x = 0; x < mbomBrkAcc.length; x++) { %>
                                                                                        <% if (mbomBrkAcc[x].idDev == mbomBrkData[j].idDev) { %>
                                                                                            <% brkAcc.push(mbomBrkAcc[x].brkAccDesc); %>
                                                                                            <% brkAccQty.push(mbomBrkAcc[x].brkAccQty); %>
                                                                                        <% } %>
                                                                                    <% } %>
                                                                                    <% let title1 = ''; %>
                                                                                    <% for (let y = 0; y < brkAcc.length; y++) { %>
                                                                                        <% let tempDesc = '('+brkAccQty[y]+')' + ' - ' + brkAcc[y]; %>
                                                                                        <% title1 += tempDesc + '<br>'; %>
                                                                                    <% } %>
                                                                                    <% if(mbomBrkData[j].catCode.includes('MC')){ %>
                                                                                        <li id="B<%= mbomBrkData[j].idDev%>" data-draggable="item" data-toggle="tooltip" data-html="true" title="<%- title1 %>" style="background-color: #fcca9c;">
                                                                                            <%= mbomBrkData[j].devDesignation %>
                                                                                        </li>
                                                                                    <% } else { %>
                                                                                        <li id="B<%= mbomBrkData[j].idDev%>" data-draggable="item" data-toggle="tooltip" data-html="true" title="<%- title1 %>" style="background-color: #b1e7d5;">
                                                                                            <%= mbomBrkData[j].devDesignation %>
                                                                                        </li>
                                                                                    <% } %>
                                                                                <% } %>
                                                                            <% } %>
                                                                        <% } %>
                                                                    <% } %>
                                                                <% } %>
                                                            </ol>
                                                        </div>
                                                    <% } %>
                                                <% } %>
                                            </div>
                                        </div>
                                    </form>
                                    <div class="row justify-content-center">
                                        <div class="col-sm-3">
                                            <label for="" class="col-form-label"></label>
                                            <button id="saveSectionBtn" class="btn-block btn-lg btn-outline-success waves-effect waves-light">Save Changes</button>
                                        </div>
                                        <div class="col-sm-3">
                                            <form id="mbomAddSection" class="mbomAddSection" action="" method="POST">
                                                <% if(mbomData) { %>
                                                    <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" placeholder="Type Number Here" id="" readonly="readonly" hidden="hidden">
                                                    <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" placeholder="Type Release Here" id="" readonly="readonly" hidden="hidden">
                                                    <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" placeholder="Type Designation Here" id="" readonly="readonly" hidden="hidden">

                                                    <label for="" class="col-form-label"></label>
                                                    <button id="generateMBOMBtn" type="submit" class="btn-block btn-lg btn-outline-secondary waves-effect waves-light add-button" onclick="this.form.action='/generateMBOM'">Generate MBOM</button>
                                                <% } %>
                                            </form>
                                        </div>
                                    </div>
                                    <p class="text-muted m-b-30"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="card m-b-20">
                                <div class="card-body">
                                    <h4 class="mt-0 header-title">Circuit Breaker Summary</h4>
                                    <form id="breakerForm" class="breakerForm" action="/addBrk" method="POST">
                                        <div class="row">
                                            <% if(mbomData) { %>
                                                <div class="col-sm-12">
                                                    <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" id="jobNum" hidden="hidden">
                                                    <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" id="releaseNum" hidden="hidden">
                                                    <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" id="mbomID" hidden="hidden">
                                                    <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" id="jobName" hidden="hidden">
                                                    <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" id="customer" hidden="hidden">
                                                    <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" id="boardDesignation" hidden="hidden">
                                                    <input type="text" name="numSections" class="form-control" value="<%= mbomData.numSections %>" id="numSections" hidden="hidden">
                                                </div>
                                            <% } %>
                                            <div class="col-sm-4">
                                                <div class="form-group">
                                                    <label for="" class="col-form-label">Layout Name</label>
                                                    <input type="text" name="devLayout" class="form-control" value="<%=mbomData.boardDesignation%>" placeholder="Layout name here" id="" readonly="readonly">
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label for="devDesLimit" class="col-form-label">Device Designation</label>
                                                    <input type="text" id="devDesLimit" maxlength="160" name="devDesignation" class="form-control counter" value="<%=brkData.devDesignation%>" data-toggle="tooltip" data-placement="top" title="To declare multiple breakers (i.e. CB-1A, CB-2A, ..., CB-6A), use the following convention: CB-(1-6)A" placeholder="Type Device Designation Here" autocomplete="off"/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-sm-3">
                                                <div class="form-group">
                                                    <label for="brkPN" class="col-form-label">Breaker P/N</label>
                                                    <input type="text" name="brkPN" class="form-control" value="<%=brkData.brkPN%>" id="brkPN" placeholder="Type Breaker P/N Here" autocomplete="off"/>
                                                </div>
                                            </div>
                                            <div class="col-sm-3">
                                                <div class="form-group">
                                                    <label for="cradlePN" class="col-form-label">Cradle P/N</label>
                                                    <input type="text" name="cradlePN" class="form-control" value="<%=brkData.cradlePN%>" id="cradlePN" placeholder="Type Cradle P/N Here" autocomplete="off"/>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="form-group">
                                                    <label for="devMfg" class="col-form-label">Manufacturer</label>
                                                    <input type="text" name="devMfg" class="form-control" value="<%=brkData.devMfg%>" id="devMfg" placeholder="Type Mfg. Here" autocomplete="off"/>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="form-group">
                                                    <label for="devCatCode" class="col-form-label">Cat. Code</label>
                                                    <select class="form-control" name="catCode" id="devCatCode">
                                                        <% if(brkData.catCode == '36-CB MC') {%>
                                                            <option value="Select">Select</option>
                                                            <option value="36-CB MC" selected>36-CB MC</option>
                                                            <option value="37-CB IC">37-CB IC</option>
                                                        <% } else if(brkData.catCode == '37-CB IC') { %>
                                                            <option value="Select">Select</option>
                                                            <option value="36-CB MC">36-CB MC</option>
                                                            <option value="37-CB IC" selected>37-CB IC</option>
                                                        <% } else { %>
                                                            <option value="Select">Select</option>
                                                            <option value="36-CB MC">36-CB MC</option>
                                                            <option value="37-CB IC">37-CB IC</option>
                                                        <% } %>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-sm-2">
                                                <% if(brkAccData.length != 0){ %>
                                                    <script> openBreakerAccessories() </script>
                                                    <div class="form-group" style="margin-top: 2.5rem; padding-left: 2.5rem;">
                                                        <input class="form-check-input" type="checkbox" name="addBreakerAccessories" id="addAccessories" checked="checked" onclick="openBreakerAccessories()">
                                                        <label class="form-check-label" for="addAccessories">Add Loose Accessories</label>
                                                    </div>
                                                <% } else { %>
                                                    <div class="form-group" style="margin-top: 2.5rem; padding-left: 2.5rem;">
                                                        <input class="form-check-input" type="checkbox" name="addBreakerAccessories" id="addAccessories" onclick="openBreakerAccessories()">
                                                        <label class="form-check-label" for="addAccessories">Add Loose Accessories</label>
                                                    </div>
                                                <% } %>
                                            </div>
                                            <div class="col-sm-2">
                                                <div class="form-group">
                                                    <label for="" class="col-form-label"></label>
                                                    <input type="text" id="" name="unitOfIssue" class="form-control" value="EA" hidden="hidden"/>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <% if(brkAccData.length != 0){ %>
                                    <div class="row" id="breakerAccessoriesDiv" style="display: flex;">
                                    <% } else { %>
                                    <div class="row" id="breakerAccessoriesDiv" style="display: none;">
                                    <% } %>
                                        <div class="col-sm-12" style="margin-top: -1rem;">
                                            <hr>
                                        </div>
                                        <div class="col-sm-9">
                                            <h6>Loose Breaker Accessories</h6>
                                        </div>
                                        <div class="col-sm-3">
                                            <h6>Current Loose Accessories</h6>
                                        </div>
                                        <div class="col-sm-9">
                                            <div class="row" >
                                                <div class="col-sm-1">
                                                    <label for="accessoryQty" class="col-form-label">Qty</label>
                                                    <input type="number" min="1" id="accessoryQty" name="accessoryQty" class="form-control" value="" placeholder="#" autocomplete="off" required/>
                                                </div>
                                                <div class="col-sm-2">
                                                    <label for="accessoryType" class="col-form-label">Accessory Type</label>
                                                    <input type="text" id="accessoryType" name="accessoryType" class="form-control" value="" placeholder="Type Accessory Type" autocomplete="off" required/>
                                                </div>
                                                <div class="col-sm-4">
                                                    <label for="accessoryDescLimit" class="col-form-label">Description</label>
                                                    <input type="text" id="accessoryDescLimit" maxlength="160" name="accessoryDesc" class="form-control" value="" placeholder="Type Accessory Description" autocomplete="off" required/>
                                                </div>
                                                <div class="col-sm-3">
                                                    <label for="accessoryPN" class="col-form-label">P/N</label>
                                                    <input type="text" id="accessoryPN" name="accessoryPN" class="form-control" value="" placeholder="Type P/N Here" autocomplete="off" required/>
                                                </div>
                                                <div class="col-sm-2" style="margin-top: 2.2rem;">
                                                    <button id="addAccessoryBtn" type="submit" class="btn btn-md btn-outline-info waves-effect waves-light" onclick="addBrkAccessory()">Add Accessory</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-3">
                                            <ul class="list-group">
                                                <% for(let i = 0; i < brkAccData.length; i++){ %>
                                                <li class="list-group-item d-flex justify-content-between align-items-center" style="padding: 4% 4% 0 4%;">
                                                    <p style="width: 50%;">
                                                        <span class="badge badge-info"><%=brkAccData[i].qty%></span>  <%=brkAccData[i].desc%>
                                                    </p>
                                                    <p>
                                                        <input id="editButton" type="submit" value="Edit" class="btn btn-md btn-outline-warning waves-effect waves-light" data-toggle="modal" data-target="#editAccModal_<%=i%>"/>
                                                        <input id="<%=brkAccData[i].pn%>" type="submit" value="Delete" class="btn btn-md btn-outline-danger waves-effect waves-light" onclick="deleteBrkAcc(this)"/>
                                                    </p>
                                                </li>

                                                <!-- EDIT BRK ACC MODAL -->
                                                <div class="modal fade" id="editAccModal_<%=i%>" tabindex="-1" role="dialog" aria-labelledby="editAccModalTitle" aria-hidden="true">
                                                    <div class="modal-dialog modal-dialog-centered" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="exampleModalLongTitle" style="font-size: large">Edit Breaker Accessory</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <p class="mb-2"></p>
                                                            <div class="col-sm-12 justify-content-center">
                                                                <p class="mb-0">
                                                                    Edit any of the following for the layout shown above, and click "Save Changes" afterwards
                                                                </p>
                                                            </div>
                                                            <div class="modal-body">
                                                                <div class="form-group">
                                                                    <div class="row">
                                                                        <div class="col-sm-3">
                                                                            <label for="editAccQty" class="col-form-label">Qty</label>
                                                                            <input type="number" min="1" id="editAccQty" name="editAccQty" class="form-control" value="<%=brkAccData[i].qty%>" placeholder="#" autocomplete="off" required/>
                                                                        </div>
                                                                        <div class="col-sm-9">
                                                                            <label for="editAccType" class="col-form-label">Accessory Type</label>
                                                                            <input type="text" id="editAccType" name="editAccType" class="form-control" value="<%=brkAccData[i].type%>" placeholder="Type Accessory Type" autocomplete="off" required/>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <label for="editAccDescLimit" class="col-form-label">Description</label>
                                                                            <input type="text" id="editAccDescLimit" maxlength="160" name="editAccDescLimit" class="form-control" value="<%=brkAccData[i].desc%>" placeholder="Type Accessory Description" autocomplete="off" required/>
                                                                        </div>
                                                                    </div>
                                                                    <div class="row">
                                                                        <div class="col-sm-12">
                                                                            <label for="editAccPN" class="col-form-label">P/N</label>
                                                                            <input type="text" id="editAccPN" name="editAccPN" class="form-control" value="<%=brkAccData[i].pn%>" placeholder="Type P/N Here" autocomplete="off" required/>
                                                                        </div>
                                                                    </div>
                                                                    <div class="modal-footer justify-content-center" style="border-top: none;">
                                                                        <input id="editBrkAccnBtn" type="submit" value="Save Changes" class="btn-block btn-lg btn-success col-sm-5" style="border: 0" onclick="editBrkAcc(<%=i%>)"/>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- END EDIT BRK ACC MODAL -->
                                                <% } %>
                                            </ul>
                                        </div>
                                    </div>
                                    <hr>
                                    <p class="text-muted m-b-15"></p>
                                    <div class="row justify-content-center">
                                        <div class="col-2">
                                            <input id="uploadBtn" type="submit" value="Add" class="btn-block btn-lg btn-outline-secondary waves-effect waves-light" form="breakerForm"/>
                                        </div>
                                    </div>
                                    <% if(mbomBrkData.length != 0){ %>
                                        <p class="text-muted m-b-30"></p>
                                        <table id="datatable" class="table table-condensed table-bordered dt-responsive nowrap">
                                            <thead>
                                            <tr>
                                                <th style="display: none;">ID</th>
                                                <th style="display:none;">MBOM ID</th>
                                                <th style="width:25%;">Device Designation</th>
                                                <th style="width:10%;">Cat. Code</th>
                                                <th style="width:25%;">Breaker P/N</th>
                                                <th style="width:25%;">Cradle P/N</th>
                                                <th style="width:15%;"></th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <% if (mbomBrkData) { %>
                                                <form id="brkForm" class="brkForm" action="" method="POST">
                                                    <% if(mbomData) { %>
                                                        <div class="col-sm-12">
                                                            <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" id="jobNum" hidden="hidden">
                                                            <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" id="releaseNum" hidden="hidden">
                                                            <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" id="mbomID" hidden="hidden">
                                                            <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" id="jobName" hidden="hidden">
                                                            <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" id="customer" hidden="hidden">
                                                            <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" id="boardDesignation" hidden="hidden">
                                                            <input type="text" name="numSections" class="form-control" value="<%= mbomData.numSections %>" id="numSections" hidden="hidden">
                                                        </div>
                                                    <% } %>
                                                    <%
                                                        let idDevs = new Set();
                                                        for(let el of mbomBrkAcc){
                                                            for(let row of mbomBrkData){
                                                                if(el.idDev == row.idDev)
                                                                    idDevs.add(el.idDev.toString());
                                                            }
                                                        }
                                                    %>
                                                    <% for (let i = 0; i < mbomBrkData.length; i++) { %>
                                                        <% let currentBrk = mbomBrkData[i].idDev;%>
                                                        <% currentBrk = currentBrk.toString(); %>
                                                        <tr data-toggle="collapse" data-target="#breaker<%=currentBrk%>" class="accordion-toggle">
                                                            <td style="display: none;"><%= mbomBrkData[i].idDev %></td>
                                                            <td style="display: none;"><%= mbomBrkData[i].mbomID %></td>
                                                            <td>
                                                                <%= mbomBrkData[i].devDesignation%>
                                                                <% if(idDevs.has(currentBrk)){ %>
                                                                    <i class="fas fa-angle-down rotate-icon"></i>
                                                                <% } %>
                                                            </td>
                                                            <td><%= mbomBrkData[i].catCode %></td>
                                                            <td><%= mbomBrkData[i].brkPN %></td>
                                                            <td><%= mbomBrkData[i].cradlePN %></td>
                                                            <td>
                                                                <input id="copyButton" type="submit" value="Copy" class="btn btn-md btn-outline-secondary waves-effect waves-light" onclick="this.form.action='../copyBreaker/?idDev=<%= mbomBrkData[i].idDev%>'"/>
                                                                <input id="editBrkButton" type="submit" value="Edit" class="btn btn-md btn-outline-warning waves-effect waves-light" onclick="this.form.action='../editBreaker/?idDev=<%= mbomBrkData[i].idDev%>'"/>
                                                                <input id="deleteButton" type="submit" value="Delete" class="btn btn-md btn-outline-danger waves-effect waves-light" onclick="this.form.action='../deleteBreaker/?idDev=<%= mbomBrkData[i].idDev%>'"/>
                                                            </td>
                                                        </tr>
                                                        <% if(idDevs.has(currentBrk)){ %>
                                                        <tr>
                                                            <td id="brkAccTD" colspan="6" class="hiddenRow">
                                                                <div class="accordion-body collapse in no-transition" id="breaker<%=currentBrk%>">
                                                                    <h6>Accessories</h6>
                                                                    <table id="brkAccTable" align="center">
                                                                        <thead>
                                                                        <tr>
                                                                            <th style="width: 10%">Qty</th>
                                                                            <th style="width: 20%">Type</th>
                                                                            <th style="width: 20%">Mfg.</th>
                                                                            <th style="width: 25%">Description</th>
                                                                            <th style="width: 25%">P/N</th>
                                                                        </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                        <% for(let row of mbomBrkAcc){ %>
                                                                        <%if(row.idDev == mbomBrkData[i].idDev){ %>
                                                                        <tr>
                                                                            <td><%=row.brkAccQty%></td>
                                                                            <td><%=row.brkAccType%></td>
                                                                            <td><%=row.brkAccMfg%></td>
                                                                            <td><%=row.brkAccDesc%></td>
                                                                            <td><%=row.brkAccPN%></td>
                                                                        </tr>
                                                                        <% } %>
                                                                        <% } %>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                        <% } %>
                                                    <% } %>
                                                </form>
                                            <% } %>
                                            </tbody>
                                        </table>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="card m-b-20">
                                <div class="card-body">
                                    <h4 class="mt-0 header-title">Item Summary</h4>
                                    <div class="card-body">
                                        <h6>Commonly Used</h6>
                                        <form id="commonItemsForm" class="commonItemsForm" action="" method="POST">
                                            <div class="form-group">
                                                <div class="row">
                                                    <% if(mbomData) { %>
                                                        <div class="col-sm-12">
                                                            <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" id="jobNum" hidden="hidden">
                                                            <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" id="releaseNum" hidden="hidden">
                                                            <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" id="mbomID" hidden="hidden">
                                                            <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" id="jobName" hidden="hidden">
                                                            <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" id="customer" hidden="hidden">
                                                            <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" id="boardDesignation" hidden="hidden">
                                                            <input type="text" name="numSections" class="form-control" value="<%= mbomData.numSections %>" id="numSections" hidden="hidden">
                                                        </div>
                                                    <% } %>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <label for="itemQty" class="col-form-label">Qty</label>
                                                        <input type="number" min="1" id="itemQty" name="itemQty" class="form-control" value="" placeholder="#" autocomplete="off" required/>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="itemSelect" class="col-form-label">Item Type</label>
                                                        <select class="form-control select2" id="itemSelect" name="itemType" required>
                                                            <option value="">Select</option>
                                                            <% let itemTypes = new Set();%>
                                                            <% for(let el of comItemData){
                                                                itemTypes.add(el.itemType);
                                                            } %>
                                                            <% for(let el of itemTypes){ %>
                                                                <option value="<%= el%>"><%=el%></option>
                                                            <% } %>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="mfgSelect" class="col-form-label">Item Mfg.</label>
                                                        <select class="form-control select2" id="mfgSelect" name="itemMfg">
                                                            <option data-parent="Select" value="Select">Select</option>
                                                            <% let itemMfg = new Set();%>
                                                            <% for(let el of comItemData){
                                                                itemMfg.add(el.itemType + "|" + el.itemMfg);
                                                            } %>
                                                            <% for(let el of itemMfg){ %>
                                                            <option data-parent="<%=el.split('|')[0]%>" value="<%= el%>"><%= el.split('|')[1]%></option>
                                                            <% } %>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-3">
                                                        <label for="descSelect" class="col-form-label">Description</label>
                                                        <select class="form-control" id="descSelect" name="itemDesc">
                                                            <option data-parent="Select" value="Select">Select</option>
                                                            <% for(let el of comItemData){ %>
                                                            <option data-parent="<%=el.itemType%>|<%=el.itemMfg%>" value="<%=el.itemType%>|<%=el.itemMfg%>|<%= el.itemDesc%>"><%=el.itemDesc%></option>
                                                            <% } %>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="pnSelect" class="col-form-label">P/N</label>
                                                        <select class="form-control" id="pnSelect" name="itemPN">
                                                            <option data-parent="Select" value="Select">Select</option>
                                                            <% for(let el of comItemData){ %>
                                                            <option data-parent="<%=el.itemType%>|<%=el.itemMfg%>|<%= el.itemDesc%>" value="<%=el.itemType%>|<%=el.itemMfg%>|<%= el.itemDesc%>|<%=el.itemPN%>"><%=el.itemPN%></option>
                                                            <% } %>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-2" style="margin-top: 2rem; padding-left: 3.5rem;">
                                                        <input class="form-check-input" type="checkbox" name="shipLoose" id="shipLoose" value="true" style="margin-top: .7rem;"/>
                                                        <label for="shipLoose" class="col-form-label">Ship Loose Item?</label>
                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-sm-2">
                                                        <label for="uploadBtn"></label>
                                                        <input id="uploadBtn" type="submit" value="Add" onclick="this.form.action='/addComItem'" class="btn-block btn-lg btn-outline-secondary waves-effect waves-light" />
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                        <h6>User Defined</h6>
                                        <form id="userDefinedForm" class="userDefinedForm" action="" method="POST">
                                            <div class="form-group">
                                                <div class="row">
                                                    <% if(mbomData) { %>
                                                        <div class="col-sm-12">
                                                            <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" id="jobNum" hidden="hidden">
                                                            <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" id="releaseNum" hidden="hidden">
                                                            <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" id="mbomID" hidden="hidden">
                                                            <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" id="jobName" hidden="hidden">
                                                            <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" id="customer" hidden="hidden">
                                                            <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" id="boardDesignation" hidden="hidden">
                                                            <input type="text" name="numSections" class="form-control" value="<%= mbomData.numSections %>" id="numSections" hidden="hidden">
                                                        </div>
                                                    <% } %>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-1">
                                                        <label for="" class="col-form-label">Qty</label>
                                                        <input type="number" min="1" id="" name="itemQty" class="form-control" value="" placeholder="#" autocomplete="off" required/>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="itemSelect2" class="col-form-label">Item Type</label>
                                                        <select class="form-control select2" id="itemSelect2" name="itemSelect2" required>
                                                            <option value="">Select</option>
                                                            <% let userItemTypes = new Set();%>
                                                            <% for(let el of comItemData){
                                                                userItemTypes.add(el.itemType);
                                                            } %>
                                                            <% for(let el of userItemTypes){ %>
                                                                <option value="<%= el%>"><%=el%></option>
                                                            <% } %>
                                                            <option>OTHER</option>
                                                        </select>
                                                        <label for="otherItemType" class="col-form-label"></label>
                                                        <input type="text" name="otherItemType" class="form-control" id="otherItemType" placeholder="Type Item Type" style="display:none;" autocomplete="off"/>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="mfgSelect2" class="col-form-label">Item Mfg.</label>
                                                        <select class="form-control select2" id="mfgSelect2" name="mfgSelect2">
                                                            <option value="">Select</option>
                                                            <% let userItemMfg = new Set();%>
                                                            <% let other = new Set()%>
                                                            <% for(let el of comItemData){
                                                                userItemMfg.add(el.itemType + "|" + el.itemMfg);
                                                            } %>
                                                            <% for(let el of comItemData){
                                                                other.add(el.itemType + "|" + "OTHER");
                                                            } %>
                                                            <% for(let el of userItemMfg){ %>
                                                            <option data-parent="<%=el.split('|')[0]%>" value="<%= el%>"><%= el.split('|')[1]%></option>
                                                            <% } %>
                                                            <% for(let el of other){ %>
                                                            <option data-parent="<%=el.split('|')[0]%>"><%=el.split('|')[1]%></option>
                                                            <% } %>
                                                        </select>
                                                        <label for="mfgList" class="col-form-label"></label>
                                                        <select class="form-control select2" id="mfgList" name="mfgList">
                                                            <option value="">Select</option>
                                                            <% let userItemMfg2 = new Set();%>
                                                            <% for(let el of comItemData){
                                                                userItemMfg2.add(el.itemMfg);
                                                            } %>
                                                            <% for(let el of userItemMfg2){ %>
                                                                <option value="<%= el%>"><%= el%></option>
                                                            <% } %>
                                                            <option>OTHER</option>
                                                        </select>
                                                        <label for="otherMfgType" class="col-form-label"></label>
                                                        <input type="text" name="otherMfgType" class="form-control" id="otherMfgType" placeholder="Type Item Mfg" style="display:none;" autocomplete="off"/>
                                                    </div>
                                                    <div class="col-sm-7">
                                                        <label for="itemDescLimit" class="col-form-label">Description</label>
                                                        <input type="text" id="itemDescLimit" maxlength="160" name="itemDesc" class="form-control" value="" placeholder="Type Item Description" autocomplete="off" required/>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-sm-6">
                                                        <label for="" class="col-form-label">P/N</label>
                                                        <input type="text" name="itemPN" id="" class="form-control" value="" placeholder="Type P/N Here" autocomplete="off" required/>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="" class="col-form-label">Unit of Issue</label>
                                                        <select class="form-control" name="unitOfIssue" id="">
                                                            <option value="Select">Select</option>
                                                            <option value="EA">EA</option>
                                                            <option value="FT">FT</option>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-2">
                                                        <label for="" class="col-form-label">Cat. Code</label>
                                                        <select class="form-control" name="catCode"  id="">
                                                            <option value="Select">Select</option>
                                                            <% for (let i = 0; i < catCodeData.length; i++) { %>
                                                                <option value="<%= catCodeData[i]%>"><%= catCodeData[i]%></option>
                                                            <% } %>
                                                        </select>
                                                    </div>
                                                    <div class="col-sm-2" style="margin-top: 2rem; padding-left: 3.5rem;">
                                                        <input class="form-check-input" type="checkbox" name="userShipLoose" id="userShipLoose" value="true" style="margin-top: .7rem;"/>
                                                        <label for="userShipLoose" class="col-form-label">Ship Loose Item?</label>
                                                    </div>
                                                </div>
                                                <div class="row justify-content-center">
                                                    <div class="col-sm-2">
                                                        <label for="uploadBtn"></label>
                                                        <input id="uploadBtn" type="submit" value="Add" class="btn-block btn-lg btn-outline-secondary waves-effect waves-light" onclick="this.form.action='/createUserItem'"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <% if(mbomItemData.length != 0){ %>
                                        <p class="text-muted m-b-30"></p>
                                        <table id="datatable" class="table table-bordered dt-responsive nowrap" style="border-collapse: collapse; border-spacing: 0; width: 100%;">
                                            <thead>
                                            <tr>
                                                <th style="display:none;">Sum Item ID</th>
                                                <th style="display:none;">Com Item ID</th>
                                                <th style="display:none;">User Item ID</th>
                                                <th style="width:5%;">Qty</th>
                                                <th style="width:20%;">Item Type</th>
                                                <th style="width:15%;">Item Mfg</th>
                                                <th style="width:23%;">Item Description</th>
                                                <th style="width:15%;">Item P/N</th>
                                                <th style="width:7%;">Ship Loose?</th>
                                                <th style="width:15%;"></th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <% if (mbomItemData) { %>
                                                <% for (let i =0; i < mbomItemData.length; i++) { %>
                                                    <form id="itemForm" class="itemForm" action="" method="POST">
                                                        <div class="row">
                                                            <% if(mbomData) { %>
                                                                <input type="text" name="jobNum" class="form-control" value="<%= mbomData.jobNum %>" id="jobNum" hidden="hidden">
                                                                <input type="text" name="releaseNum" class="form-control" value="<%= mbomData.releaseNum %>" id="releaseNum" hidden="hidden">
                                                                <input type="text" name="mbomID" class="form-control" value="<%= mbomData.mbomID %>" id="mbomID" hidden="hidden">
                                                                <input type="text" name="jobName" class="form-control" value="<%= mbomData.jobName %>" id="jobName" hidden="hidden">
                                                                <input type="text" name="customer" class="form-control" value="<%= mbomData.customer %>" id="customer" hidden="hidden">
                                                                <input type="text" name="boardDesignation" class="form-control" value="<%= mbomData.boardDesignation %>" id="boardDesignation" hidden="hidden">
                                                                <input type="text" name="numSections" class="form-control" value="<%= mbomData.numSections %>" id="numSections" hidden="hidden">
                                                            <% } %>
                                                        </div>
                                                        <% if (mbomItemData[i].userItemID == null) { %>
                                                        <%for(var j = 0; j < comItemData.length; j++){ %>
                                                        <%if(mbomItemData[i].comItemID == comItemData[j].comItemID){ %>
                                                            <tr>
                                                                <td style="display: none;"><%= mbomItemData[i].itemSumID %></td>
                                                                <td style="display: none;"><%= mbomItemData[i].comItemID %></td>
                                                                <td style="display: none;"><%= mbomItemData[i].userItemID %></td>
                                                                <td><%= mbomItemData[i].itemQty %></td>
                                                                <td><%= comItemData[j].itemType %></td>
                                                                <td><%= comItemData[j].itemMfg %></td>
                                                                <td><%= comItemData[j].itemDesc %></td>
                                                                <td><%= comItemData[j].itemPN %></td>
                                                                <td><%= mbomItemData[i].shipLoose %></td>
                                                                <td>
                                                                    <input id="copyButton" type="submit" value="Copy" class="btn btn-md btn-outline-secondary waves-effect waves-light" onclick="this.form.action='../copyItem/?itemSumID=<%= mbomItemData[i].itemSumID%>'"/>
                                                                    <% if(mbomItemData[i].userItemID != null){%>
                                                                        <input id="editButton" type="submit" value="Edit" class="btn btn-md btn-outline-warning waves-effect waves-light" onclick="this.form.action='../editUserItem/?itemSumID=<%= mbomItemData[i].itemSumID%>&userItemID=<%=mbomItemData[i].userItemID%>'"/>
                                                                    <% }else{ %>
                                                                        <input id="editButton" type="submit" value="Edit" class="btn btn-md btn-outline-warning waves-effect waves-light" onclick="this.form.action='../editComItem/?itemSumID=<%= mbomItemData[i].itemSumID%>&comItemID=<%=mbomItemData[i].comItemID%>'"/>
                                                                    <% } %>
                                                                    <input id="deleteButton" type="submit" value="Delete" class="btn btn-md btn-outline-danger waves-effect waves-light" onclick="this.form.action='../deleteItem/?itemSumID=<%= mbomItemData[i].itemSumID %>'"/>
                                                                </td>
                                                            </tr>
                                                        <% } %>
                                                        <% } %>
                                                        <% } else { %>
                                                        <%for(let j = 0; j < userItemData.length; j++){ %>
                                                        <%if(mbomItemData[i].userItemID == userItemData[j].userItemID){ %>
                                                            <tr>
                                                                <td style="display: none;"><%= mbomItemData[i].itemSumID %></td>
                                                                <td style="display: none;"><%= mbomItemData[i].comItemID %></td>
                                                                <td style="display: none;"><%= mbomItemData[i].userItemID %></td>
                                                                <td><%= mbomItemData[i].itemQty %></td>
                                                                <td><%= userItemData[j].itemType %></td>
                                                                <td><%= userItemData[j].itemMfg %></td>
                                                                <td><%= userItemData[j].itemDesc %></td>
                                                                <td><%= userItemData[j].itemPN %></td>
                                                                <td><%= mbomItemData[i].shipLoose %></td>
                                                                <td>
                                                                    <input id="copyButton" type="submit" value="Copy" class="btn btn-md btn-outline-secondary waves-effect waves-light" onclick="this.form.action='../copyItem/?itemSumID=<%= mbomItemData[i].itemSumID%>'"/>
                                                                    <% if(mbomItemData[i].userItemID != null){%>
                                                                        <input id="editButton" type="submit" value="Edit" class="btn btn-md btn-outline-warning waves-effect waves-light" onclick="this.form.action='../editUserItem/?itemSumID=<%= mbomItemData[i].itemSumID%>&userItemID=<%=mbomItemData[i].userItemID%>'" />
                                                                    <% }else{ %>
                                                                        <input id="editButton" type="submit" value="Edit" class="btn btn-md btn-outline-warning waves-effect waves-light" onclick="this.form.action='../editComItem/?itemSumID=<%= mbomItemData[i].itemSumID%>&comItemID=<%=mbomItemData[i].comItemID%>'"/>
                                                                    <% } %>
                                                                    <input id="deleteButton" type="submit" value="Delete" class="btn btn-md btn-outline-danger waves-effect waves-light" onclick="this.form.action='../deleteItem/?itemSumID=<%= mbomItemData[i].itemSumID %>'"/>
                                                                </td>
                                                            </tr>
                                                        <% } %>
                                                        <% } %>
                                                        <% } %>
                                                    </form>
                                                <% } %>
                                            <% } %>
                                            </tbody>
                                        </table>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    </div>
                </div>
            </div>
        </div> <!-- container-fluid -->
    </div> <!-- content -->
</div> <!-- content-page -->
    <footer class="footer">
         2019 SAI, Advanced Power Solutions Inc.
    </footer>
</div> <!-- wrapper -->


<!-- Responsive-table-->
<script src="/public/plugins/RWD-Table-Patterns/dist/js/rwd-table.min.js"></script>
<script>
    $(function() {
        $('.table-responsive').responsiveTable({
            addDisplayAllBtn: 'btn btn-secondary'
        });
    });
</script>


<!-- Plugins js -->
<script src="/public/plugins/morris/morris.min.js"></script>
<script src="/public/plugins/raphael/raphael-min.js"></script>
<script src="/public/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js"></script>
<script src="/public/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="/public/plugins/select2/js/select2.min.js"></script>
<script src="/public/plugins/bootstrap-maxlength/bootstrap-maxlength.min.js"></script>
<script src="/public/plugins/bootstrap-filestyle/js/bootstrap-filestyle.min.js"></script>
<script src="/public/plugins/bootstrap-touchspin/js/jquery.bootstrap-touchspin.min.js"></script>
<script src="/public/plugins/ion-rangeslider/ion.rangeSlider.min.js"></script>
<script src="/public/plugins/jquery-sparkline/jquery.sparkline.min.js"></script>

<!-- Assets js -->
<script src="/public/assets/js/jquery.min.js"></script>
<script src="/public/assets/js/bootstrap.bundle.min.js"></script>
<script src="/public/assets/js/metisMenu.min.js"></script>
<script src="/public/assets/js/jquery.slimscroll.js"></script>
<script src="/public/assets/js/waves.min.js"></script>
<script src="/public/assets/pages/dashboard.js"></script>
<script src="/public/assets/pages/rangeslider-init.js"></script>
<script src="/public/assets/pages/form-advanced.js"></script>
<script src="/public/assets/js/app.js"></script>
<script src="/public/plugins/ion-rangeslider/ion.rangeSlider.min.js"></script>
<script src="/public/assets/js/characterLimit.js"></script>
<script src="/public/assets/js/mbomCheckbox.js"></script>
<script src="/public/assets/js/mbomBreakerAccessories.js"></script>
<script src="/public/assets/js/mbomAccTooltips.js"></script>


<!-- User developed scripts -->
<script src="/public/assets/js/mbomFilterDropdown.js"></script>
<script src="/public/assets/js/mbomDragDrop.js"></script>



</body>
</html>
